webpackJsonp([24],{1727:function(e,t,a){"use strict";(function(e){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(71),n=s(l),i=a(6),o=s(i),u=a(2),d=s(u),m=a(4),c=s(m),f=a(5),p=s(f),E=a(3),g=s(E),h=a(164),v=s(h),_=a(41),w=r(_),y=a(165),N=a(79),M=s(N),b=a(333),S=a(46),k=a(11),I=r(k),L=a(8),F=s(L),C=a(1),T=s(C),U=a(13),P=a(37),A=a(1659),x=s(A),H=function(t){function a(e){(0,d.default)(this,a);var t=(0,c.default)(this,(a.__proto__||(0,o.default)(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.getInviteInfo=t.getInviteInfo.bind(t),t.renderEmailSignup=t.renderEmailSignup.bind(t),t.isUserValid=t.isUserValid.bind(t),t.state=t.getInviteInfo(),t}return(0,g.default)(a,t),(0,p.default)(a,null,[{key:"propTypes",get:function(){return{location:T.default.PropTypes.object}}}]),(0,p.default)(a,[{key:"componentDidMount",value:function(){(0,y.trackEvent)("signup","signup_user_01_welcome")}},{key:"getInviteInfo",value:function(){var e=this.props.location.query.d,t=this.props.location.query.h,a=this.props.location.query.id,r="",s="",l="",n="",i=!0,o="",u=!1;if(t&&t.length>0){var d=JSON.parse(e);r=d.email,s=d.display_name,l=d.name,n=d.id,i=!1}else a&&a.length>0?(i=!0,(0,b.getInviteInfo)(a,function(e){e&&(o="",s=e.display_name,l=e.name,n=e.id)},function(){u=!0,o=T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.invalid_invite",defaultMessage:"The invite link was invalid.  Please speak with your Administrator to receive an invitation."})}),i=!1,e=null,t=null):i=!1;return{data:e,hash:t,email:r,teamDisplayName:s,teamName:l,teamId:n,inviteId:a,loading:i,serverError:o,noOpenServerError:u}}},{key:"finishSignup",value:function(){var e=this;w.emitInitialLoad(function(){var t=e.props.location.query;w.loadDefaultLocale(),t.redirect_to?P.browserHistory.push(t.redirect_to):w.redirectUserToDefaultTeam()})}},{key:"handleSignupSuccess",value:function(e,t){var a=this;(0,y.trackEvent)("signup","signup_user_02_complete"),(0,S.loginById)(t.id,e.password,"",function(){a.state.hash>0&&M.default.setGlobalItem(a.state.hash,(0,n.default)({usedBefore:!0})),w.emitInitialLoad(function(){var e=a.props.location.query;e.redirect_to?P.browserHistory.push(e.redirect_to):w.redirectUserToDefaultTeam()})},function(t){"api.user.login.not_verified.app_error"===t.id?P.browserHistory.push("/should_verify_email?email="+encodeURIComponent(e.email)+"&teamname="+encodeURIComponent(a.state.teamName)):a.setState({serverError:t.message})})}},{key:"isUserValid",value:function(){var e=this.refs.email.value.trim();if(!e)return this.setState({nameError:"",emailError:T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.required"}),passwordError:"",serverError:""}),!1;if(!I.isEmail(e))return this.setState({nameError:"",emailError:T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.validEmail"}),passwordError:"",serverError:""}),!1;var t=this.refs.name.value.trim().toLowerCase();if(!t)return this.setState({nameError:T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.required"}),emailError:"",passwordError:"",serverError:""}),!1;var a=I.isValidUsername(t);if("Cannot use a reserved word as a username."===a)return this.setState({nameError:T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.reserved"}),emailError:"",passwordError:"",serverError:""}),!1;if(a)return this.setState({nameError:T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.usernameLength",values:{min:F.default.MIN_USERNAME_LENGTH,max:F.default.MAX_USERNAME_LENGTH}}),emailError:"",passwordError:"",serverError:""}),!1;var r=this.refs.password.value,s=I.isValidPassword(r);return!s||(this.setState({nameError:"",emailError:"",passwordError:s,serverError:""}),!1)}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),this.isUserValid()){this.setState({nameError:"",emailError:"",passwordError:"",serverError:""});var a={email:this.refs.email.value.trim(),username:this.refs.name.value.trim().toLowerCase(),password:this.refs.password.value,allow_marketing:!0};(0,S.createUserWithInvite)(a,this.state.data,this.state.hash,this.state.inviteId,this.handleSignupSuccess.bind(this,a),function(e){t.setState({serverError:e.message})})}}},{key:"renderEmailSignup",value:function(){var t=null,a=T.default.createElement("span",{className:"help-block"},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.emailHelp",defaultMessage:"Valid email required for sign-up"})),r="form-group";this.state.emailError&&(t=T.default.createElement("label",{className:"control-label"},this.state.emailError),a="",r+=" has-error");var s=null,l=T.default.createElement("span",{className:"help-block"},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.userHelp",defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-' and '_'",values:{min:F.default.MIN_USERNAME_LENGTH,max:F.default.MAX_USERNAME_LENGTH}})),n="form-group";this.state.nameError&&(s=T.default.createElement("label",{className:"control-label"},this.state.nameError),l="",n+=" has-error");var i=null,o="form-group";this.state.passwordError&&(i=T.default.createElement("label",{className:"control-label"},this.state.passwordError),o+=" has-error");var u=null;this.state.email&&(u=T.default.createElement(U.FormattedHTMLMessage,{id:"signup_user_completed.emailIs",defaultMessage:"Your email address is <strong>{email}</strong>. You'll use this address to sign in to {siteName}.",values:{email:this.state.email,siteName:e.window.mm_config.SiteName}}));var d="margin--extra";return this.state.email&&(d="hidden"),T.default.createElement("form",null,T.default.createElement("div",{className:"inner__content"},T.default.createElement("div",{className:d},T.default.createElement("h5",null,T.default.createElement("strong",null,T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.whatis",defaultMessage:"What's your email address?"}))),T.default.createElement("div",{className:r},T.default.createElement("input",{type:"email",ref:"email",className:"form-control",defaultValue:this.state.email,placeholder:"",maxLength:"128",autoFocus:!0,spellCheck:"false",autoCapitalize:"off"}),t,a)),u,T.default.createElement("div",{className:"margin--extra"},T.default.createElement("h5",null,T.default.createElement("strong",null,T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.chooseUser",defaultMessage:"Choose your username"}))),T.default.createElement("div",{className:n},T.default.createElement("input",{type:"text",ref:"name",className:"form-control",placeholder:"",maxLength:F.default.MAX_USERNAME_LENGTH,spellCheck:"false",autoCapitalize:"off"}),s,l)),T.default.createElement("div",{className:"margin--extra"},T.default.createElement("h5",null,T.default.createElement("strong",null,T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.choosePwd",defaultMessage:"Choose your password"}))),T.default.createElement("div",{className:o},T.default.createElement("input",{type:"password",ref:"password",className:"form-control",placeholder:"",maxLength:"128",spellCheck:"false"}),i)),T.default.createElement("p",{className:"margin--extra"},T.default.createElement("button",{type:"submit",onClick:this.handleSubmit,className:"btn-primary btn"},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.create",defaultMessage:"Create Account"})))))}},{key:"render",value:function(){var t=null;if(this.state.serverError&&(t=T.default.createElement("div",{className:"form-group has-error"},T.default.createElement("label",{className:"control-label"},this.state.serverError))),this.state.loading)return T.default.createElement(v.default,null);var a=void 0;if("true"!==e.window.mm_config.EnableSignUpWithEmail)return null;a=this.renderEmailSignup();var r=null;!this.state.noOpenServerError&&a&&(r=T.default.createElement("p",null,T.default.createElement(U.FormattedHTMLMessage,{id:"create_team.agreement",defaultMessage:"By proceeding to create your account and use {siteName}, you agree to our <a href='{TermsOfServiceLink}'>Terms of Service</a> and <a href='{PrivacyPolicyLink}'>Privacy Policy</a>. If you do not agree, you cannot use {siteName}.",values:{siteName:e.window.mm_config.SiteName,TermsOfServiceLink:e.window.mm_config.TermsOfServiceLink,PrivacyPolicyLink:e.window.mm_config.PrivacyPolicyLink}}))),this.state.noOpenServerError&&(a=null);var s=null;return s="true"===e.window.mm_license.IsLicensed&&"true"===e.window.mm_license.CustomBrand&&"true"===e.window.mm_config.EnableCustomBrand?e.window.mm_config.CustomDescriptionText:T.default.createElement(U.FormattedMessage,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),T.default.createElement("div",null,T.default.createElement("div",{className:"signup-header"},T.default.createElement(P.Link,{to:"/"},T.default.createElement("span",{className:"fa fa-chevron-left"}),T.default.createElement(U.FormattedMessage,{id:"web.header.back"}))),T.default.createElement("div",{className:"col-sm-12"},T.default.createElement("div",{className:"signup-team__container padding--less"},T.default.createElement("img",{className:"signup-team-logo",src:x.default}),T.default.createElement("h1",null,e.window.mm_config.SiteName),T.default.createElement("h4",{className:"color--light"},s),T.default.createElement("h4",{className:"color--light"},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.lets",defaultMessage:"Let's create your account"})),T.default.createElement("span",{className:"color--light"},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.haveAccount",defaultMessage:"Already have an account?"})," ",T.default.createElement(P.Link,{to:"/login",query:this.props.location.query},T.default.createElement(U.FormattedMessage,{id:"signup_user_completed.signIn",defaultMessage:"Click here to sign in."}))),a,t,r)))}}]),a}(T.default.Component);t.default=H}).call(t,a(17))}});
//# sourceMappingURL=24.b238ea5b0c01fed16a99.js.map