webpackJsonp([49],{1691:function(e,a,t){"use strict";function s(e){if(e&&e.__esModule)return e;var a={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]);return a.default=e,a}function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(a,"__esModule",{value:!0});var m=t(6),i=l(m),r=t(2),n=l(r),d=t(5),o=l(d),u=t(4),c=l(u),f=t(3),g=l(f),h=t(1),p=l(h),v=t(20),E=s(v),b=t(80),_=l(b),j=t(336),M=l(j),y=t(13),N=t(332),F=l(N),S=t(335),k=t(243),w=l(k),C=function(e){function a(e){(0,n.default)(this,a);var t=(0,c.default)(this,(a.__proto__||(0,i.default)(a)).call(this,e));return t.handleSubmit=t.handleSubmit.bind(t),t.updateName=t.updateName.bind(t),t.updateImage=t.updateImage.bind(t),t.state={name:"",image:null,imageUrl:"",saving:!1,error:null},t}return(0,g.default)(a,e),(0,o.default)(a,[{key:"handleSubmit",value:function(e){var a=this;if(e.preventDefault(),!this.state.saving){this.setState({saving:!0,error:null});var t={creator_id:this.props.user.id,name:this.state.name.trim().toLowerCase()};return t.name.startsWith(":")&&t.name.endsWith(":")&&(t.name=t.name.substring(1,t.name.length-1)),t.name?/[^a-z0-9_-]/.test(t.name)?void this.setState({saving:!1,error:p.default.createElement(y.FormattedMessage,{id:"add_emoji.nameInvalid",defaultMessage:"An emoji's name can only contain lowercase letters, numbers, and the symbols '-' and '_'."})}):_.default.hasSystemEmoji(t.name)?void this.setState({saving:!1,error:p.default.createElement(y.FormattedMessage,{id:"add_emoji.nameTaken",defaultMessage:"This name is already in use by a system emoji. Please choose another name."})}):this.state.image?void E.addEmoji(t,this.state.image,function(){a.context.router.push("/"+a.props.team.name+"/emoji")},function(e){a.setState({saving:!1,error:e.message})}):void this.setState({saving:!1,error:p.default.createElement(y.FormattedMessage,{id:"add_emoji.imageRequired",defaultMessage:"An image is required for the emoji"})}):void this.setState({saving:!1,error:p.default.createElement(y.FormattedMessage,{id:"add_emoji.nameRequired",defaultMessage:"A name is required for the emoji"})})}}},{key:"updateName",value:function(e){this.setState({name:e.target.value})}},{key:"updateImage",value:function(e){var a=this;if(0===e.target.files.length)return void this.setState({image:null,imageUrl:""});var t=e.target.files[0],s=new FileReader;s.onload=function(){a.setState({image:t,imageUrl:s.result})},s.readAsDataURL(t)}},{key:"render",value:function(){var e=null;this.state.image&&(e=p.default.createElement("span",{className:"add-emoji__filename"},this.state.image.name));var a=null;return this.state.imageUrl&&(a=p.default.createElement("div",{className:"form-group"},p.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"preview"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.preview",defaultMessage:"Preview"})),p.default.createElement("div",{className:"col-md-5 col-sm-8 add-emoji__preview"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.preview.sentence",defaultMessage:"This is a sentence with {image} in it.",values:{image:p.default.createElement("span",{className:"emoticon",style:{backgroundImage:"url("+this.state.imageUrl+")"}})}})))),p.default.createElement("div",{className:"backstage-content row"},p.default.createElement(M.default,null,p.default.createElement(S.Link,{to:"/"+this.props.team.name+"/emoji"},p.default.createElement(y.FormattedMessage,{id:"emoji_list.header",defaultMessage:"Custom Emoji"})),p.default.createElement(y.FormattedMessage,{id:"add_emoji.header",defaultMessage:"Add"})),p.default.createElement("div",{className:"backstage-form"},p.default.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},p.default.createElement("div",{className:"form-group"},p.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"name"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.name",defaultMessage:"Name"})),p.default.createElement("div",{className:"col-md-5 col-sm-8"},p.default.createElement("input",{id:"name",type:"text",maxLength:"64",className:"form-control",value:this.state.name,onChange:this.updateName}),p.default.createElement("div",{className:"form__help"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.name.help",defaultMessage:"Choose a name for your emoji made of up to 64 characters consisting of lowercase letters, numbers, and the symbols '-' and '_'."})))),p.default.createElement("div",{className:"form-group"},p.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"image"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.image",defaultMessage:"Image"})),p.default.createElement("div",{className:"col-md-5 col-sm-8"},p.default.createElement("div",null,p.default.createElement("div",{className:"add-emoji__upload"},p.default.createElement("button",{className:"btn btn-primary"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.image.button",defaultMessage:"Select"})),p.default.createElement("input",{type:"file",accept:".jpg,.png,.gif",multiple:!1,onChange:this.updateImage})),e,p.default.createElement("div",{className:"form__help"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.image.help",defaultMessage:"Choose the image for your emoji. The image can be a gif, png, or jpeg file with a max size of 64 KB and dimensions up to 128 by 128 pixels."}))))),a,p.default.createElement("div",{className:"backstage-form__footer"},p.default.createElement(F.default,{type:"backstage",error:this.state.error}),p.default.createElement(S.Link,{className:"btn btn-sm",to:"/"+this.props.team.name+"/emoji"},p.default.createElement(y.FormattedMessage,{id:"add_emoji.cancel",defaultMessage:"Cancel"})),p.default.createElement(w.default,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit},p.default.createElement(y.FormattedMessage,{id:"add_emoji.save",defaultMessage:"Save"}))))))}}]),a}(p.default.Component);C.propTypes={team:p.default.PropTypes.object,user:p.default.PropTypes.object},C.contextTypes={router:p.default.PropTypes.object.isRequired},a.default=C}});
//# sourceMappingURL=49.9c01ffde42179fd0a314.js.map