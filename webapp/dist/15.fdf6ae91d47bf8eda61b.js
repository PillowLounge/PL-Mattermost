webpackJsonp([15],{1724:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(6),l=s(n),o=a(2),i=s(o),u=a(5),r=s(u),d=a(4),f=s(d),h=a(3),S=s(h),c=a(0),C=s(c),g=a(1),p=s(g),_=a(1672),E=s(_),m=a(2024),T=s(m),P=a(24),A=s(P),y=a(23),L=s(y),I=a(37),v=a(13),D=function(e){function t(e){(0,i.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return a.getStateFromStores=a.getStateFromStores.bind(a),a.isStateValid=a.isStateValid.bind(a),a.updateState=a.updateState.bind(a),a.state=a.getStateFromStores(e),a}return(0,S.default)(t,e),(0,r.default)(t,[{key:"getStateFromStores",value:function(e){var t=e.params.postid,a=A.default.getCurrent(),s=a?a.id:"",n=a?a.name:"",l=L.default.getCurrent();return{channelId:s,channelName:n,teamName:l?l.name:"",postId:t}}},{key:"isStateValid",value:function(){return""!==this.state.channelId&&this.state.teamName}},{key:"updateState",value:function(){this.setState(this.getStateFromStores(this.props))}},{key:"componentDidMount",value:function(){A.default.addChangeListener(this.updateState),L.default.addChangeListener(this.updateState),(0,C.default)("body").addClass("app__body")}},{key:"componentWillUnmount",value:function(){A.default.removeChangeListener(this.updateState),L.default.removeChangeListener(this.updateState),(0,C.default)("body").removeClass("app__body")}},{key:"componentWillReceiveProps",value:function(e){this.setState(this.getStateFromStores(e))}},{key:"render",value:function(){return this.isStateValid()?p.default.createElement("div",{id:"app-content",className:"app__content"},p.default.createElement(E.default,{channelId:this.state.channelId}),p.default.createElement(T.default,null),p.default.createElement("div",{id:"archive-link-home"},p.default.createElement(I.Link,{to:"/"+this.state.teamName+"/channels/"+this.state.channelName},p.default.createElement(v.FormattedMessage,{id:"center_panel.recent",defaultMessage:"Click here to jump to recent messages. "}),p.default.createElement("i",{className:"fa fa-arrow-down"})))):null}}]),t}(p.default.Component);t.default=D,D.propTypes={params:p.default.PropTypes.object.isRequired}},2024:function(e,t,a){"use strict";function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(71),o=n(l),i=a(31),u=n(i),r=a(6),d=n(r),f=a(2),h=n(f),S=a(5),c=n(S),C=a(4),g=n(C),p=a(3),_=n(p),E=a(1677),m=n(E),T=a(164),P=n(T),A=a(80),y=n(A),L=a(140),I=n(L),v=a(15),D=n(v),N=a(24),Y=n(N),G=a(42),M=n(G),O=a(334),b=n(O),k=a(11),B=s(k),R=a(8),j=n(R),U=a(1),F=n(U),V=j.default.Preferences,w=j.default.ScrollTypes,H=function(e){function t(e){(0,h.default)(this,t);var a=(0,g.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));a.onChannelChange=a.onChannelChange.bind(a),a.onPostsChange=a.onPostsChange.bind(a),a.onUserChange=a.onUserChange.bind(a),a.onEmojiChange=a.onEmojiChange.bind(a),a.onStatusChange=a.onStatusChange.bind(a),a.onPreferenceChange=a.onPreferenceChange.bind(a),a.onPostListScroll=a.onPostListScroll.bind(a),a.onBusy=a.onBusy.bind(a);var s=I.default.getFocusedPostId(),n=Y.default.getCurrent(),l=D.default.getProfiles(),o=M.default.getBool(j.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"join_leave",!0),i=void 0;return n&&(i=(0,u.default)({},D.default.getStatuses())),a.state={postList:I.default.filterPosts(s,o),currentUser:D.default.getCurrentUser(),isBusy:b.default.isBusy(),profiles:l,statuses:i,scrollType:w.POST,currentChannel:Y.default.getCurrentId().slice(),scrollPostId:s,atTop:I.default.getVisibilityAtTop(s),atBottom:I.default.getVisibilityAtBottom(s),emojis:y.default.getEmojis(),displayNameType:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,"name_format","false"),displayPostsInCenter:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.CHANNEL_DISPLAY_MODE,V.CHANNEL_DISPLAY_MODE_DEFAULT)===V.CHANNEL_DISPLAY_MODE_CENTERED,compactDisplay:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.MESSAGE_DISPLAY,V.MESSAGE_DISPLAY_DEFAULT)===V.MESSAGE_DISPLAY_COMPACT,previewsCollapsed:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.COLLAPSE_DISPLAY,"false"),useMilitaryTime:M.default.getBool(j.default.Preferences.CATEGORY_DISPLAY_SETTINGS,V.USE_MILITARY_TIME,!1),flaggedPosts:M.default.getCategory(j.default.Preferences.CATEGORY_FLAGGED_POST)},a}return(0,_.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){Y.default.addChangeListener(this.onChannelChange),I.default.addChangeListener(this.onPostsChange),D.default.addChangeListener(this.onUserChange),D.default.addStatusesChangeListener(this.onStatusChange),y.default.addChangeListener(this.onEmojiChange),M.default.addChangeListener(this.onPreferenceChange),b.default.addBusyListener(this.onBusy)}},{key:"componentWillUnmount",value:function(){Y.default.removeChangeListener(this.onChannelChange),I.default.removeChangeListener(this.onPostsChange),D.default.removeChangeListener(this.onUserChange),D.default.removeStatusesChangeListener(this.onStatusChange),y.default.removeChangeListener(this.onEmojiChange),M.default.removeChangeListener(this.onPreferenceChange),b.default.removeBusyListener(this.onBusy)}},{key:"onChannelChange",value:function(){var e=Y.default.getCurrentId();this.state.currentChannel!==e&&this.setState({currentChannel:e.slice(),scrollType:w.POST})}},{key:"onPostsChange",value:function(){var e=I.default.getFocusedPostId();if(null!=e){var t=M.default.getBool(j.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"join_leave",!0);this.setState({scrollPostId:e,postList:I.default.filterPosts(e,t),atTop:I.default.getVisibilityAtTop(e),atBottom:I.default.getVisibilityAtBottom(e)})}}},{key:"onUserChange",value:function(){this.setState({currentUser:D.default.getCurrentUser(),profiles:JSON.parse((0,o.default)(D.default.getProfiles()))})}},{key:"onStatusChange",value:function(){var e=Y.default.getCurrent(),t=void 0;e&&(t=(0,u.default)({},D.default.getStatuses())),this.setState({statuses:t})}},{key:"onEmojiChange",value:function(){this.setState({emojis:y.default.getEmojis()})}},{key:"onPreferenceChange",value:function(e){var t="";e===V.CATEGORY_DISPLAY_SETTINGS&&(t="_"+B.generateId());var a=I.default.getFocusedPostId();if(null!=a){var s=M.default.getBool(j.default.Preferences.CATEGORY_ADVANCED_SETTINGS,"join_leave",!0);this.setState({postList:I.default.filterPosts(a,s),displayNameType:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,"name_format","false"),displayPostsInCenter:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.CHANNEL_DISPLAY_MODE,V.CHANNEL_DISPLAY_MODE_DEFAULT)===V.CHANNEL_DISPLAY_MODE_CENTERED,compactDisplay:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.MESSAGE_DISPLAY,V.MESSAGE_DISPLAY_DEFAULT)===V.MESSAGE_DISPLAY_COMPACT,previewsCollapsed:M.default.get(V.CATEGORY_DISPLAY_SETTINGS,V.COLLAPSE_DISPLAY,"false")+t,useMilitaryTime:M.default.getBool(j.default.Preferences.CATEGORY_DISPLAY_SETTINGS,V.USE_MILITARY_TIME,!1),flaggedPosts:M.default.getCategory(j.default.Preferences.CATEGORY_FLAGGED_POST)})}}},{key:"onPostListScroll",value:function(){this.setState({scrollType:w.FREE})}},{key:"onBusy",value:function(e){this.setState({isBusy:e})}},{key:"render",value:function(){var e={};e[this.state.scrollPostId]=!0;var t=void 0;return t=null==this.state.postList?F.default.createElement(P.default,{position:"absolute",key:"loading"}):F.default.createElement(m.default,{postList:this.state.postList,currentUser:this.state.currentUser,profiles:this.state.profiles,scrollType:this.state.scrollType,scrollPostId:this.state.scrollPostId,postListScrolled:this.onPostListScroll,displayNameType:this.state.displayNameType,displayPostsInCenter:this.state.displayPostsInCenter,compactDisplay:this.state.compactDisplay,previewsCollapsed:this.state.previewsCollapsed,useMilitaryTime:this.state.useMilitaryTime,showMoreMessagesTop:!this.state.atTop,showMoreMessagesBottom:!this.state.atBottom,postsToHighlight:e,isFocusPost:!0,emojis:this.state.emojis,flaggedPosts:this.state.flaggedPosts,statuses:this.state.statuses,isBusy:this.state.isBusy}),F.default.createElement("div",{id:"post-list"},t)}}]),t}(F.default.Component);t.default=H}});
//# sourceMappingURL=15.fdf6ae91d47bf8eda61b.js.map