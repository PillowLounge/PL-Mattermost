webpackJsonp([35],{1708:function(e,t,a){"use strict";function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(6),d=s(o),n=a(2),m=s(n),r=a(4),i=s(r),c=a(5),u=s(c),p=a(3),h=s(p),f=a(1),g=s(f),E=a(20),v=l(E),_=a(1660),M=s(_),b=a(23),N=s(b),C=a(11),y=l(C),F=a(1664),k=a(336),w=s(k),S=a(13),U=a(332),x=s(U),D=a(37),T=a(243),R=s(T),A=a(8),L=s(A),H=a(242),I=s(H),G="P",q="G",O=function(e){function t(e){(0,m.default)(this,t);var a=(0,i.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));a.handleIntegrationChange=a.handleIntegrationChange.bind(a),a.submitCommand=a.submitCommand.bind(a),a.handleSubmit=a.handleSubmit.bind(a),a.handleUpdate=a.handleUpdate.bind(a),a.handleConfirmModal=a.handleConfirmModal.bind(a),a.confirmModalDismissed=a.confirmModalDismissed.bind(a),a.updateDisplayName=a.updateDisplayName.bind(a),a.updateDescription=a.updateDescription.bind(a),a.updateTrigger=a.updateTrigger.bind(a),a.updateUrl=a.updateUrl.bind(a),a.updateMethod=a.updateMethod.bind(a),a.updateUsername=a.updateUsername.bind(a),a.updateIconUrl=a.updateIconUrl.bind(a),a.updateAutocomplete=a.updateAutocomplete.bind(a),a.updateAutocompleteHint=a.updateAutocompleteHint.bind(a),a.updateAutocompleteDescription=a.updateAutocompleteDescription.bind(a),a.originalCommand=null,a.newCommand=null;var l=N.default.getCurrentId();return a.state={displayName:"",description:"",trigger:"",url:"",method:G,username:"",iconUrl:"",autocomplete:!1,autocompleteHint:"",autocompleteDescription:"",saving:!1,serverError:"",clientError:null,showConfirmModal:!1,commands:M.default.getCommands(l),loading:!M.default.hasReceivedCommands(l)},a}return(0,h.default)(t,e),(0,u.default)(t,null,[{key:"propTypes",get:function(){return{team:g.default.PropTypes.object,location:g.default.PropTypes.object}}}]),(0,u.default)(t,[{key:"componentDidMount",value:function(){M.default.addChangeListener(this.handleIntegrationChange),"true"===window.mm_config.EnableCommands&&(0,F.loadTeamCommands)()}},{key:"componentWillUnmount",value:function(){M.default.removeChangeListener(this.handleIntegrationChange)}},{key:"handleConfirmModal",value:function(){this.setState({showConfirmModal:!0})}},{key:"confirmModalDismissed",value:function(){this.setState({showConfirmModal:!1})}},{key:"submitCommand",value:function(){var e=this;v.editCommand(this.newCmd,D.browserHistory.push("/"+this.props.team.name+"/integrations/commands"),function(t){e.setState({saving:!1,serverError:t.message})})}},{key:"handleUpdate",value:function(){this.setState({saving:!0,serverError:"",clientError:""}),this.submitCommand()}},{key:"handleIntegrationChange",value:function(){var e=this,t=N.default.getCurrentId();this.setState({commands:M.default.getCommands(t),loading:!M.default.hasReceivedCommands(t)}),this.state.loading||(this.originalCommand=this.state.commands.filter(function(t){return t.id===e.props.location.query.id})[0],this.setState({displayName:this.originalCommand.display_name,description:this.originalCommand.description,trigger:this.originalCommand.trigger,url:this.originalCommand.url,method:this.originalCommand.method,username:this.originalCommand.username,iconUrl:this.originalCommand.icon_url,autocomplete:this.originalCommand.auto_complete,autocompleteHint:this.originalCommand.auto_complete_hint,autocompleteDescription:this.originalCommand.auto_complete_desc}))}},{key:"handleSubmit",value:function(e){if(e.preventDefault(),!this.state.saving){this.setState({saving:!0,serverError:"",clientError:""});var t=this.state.trigger.trim().toLowerCase();0===t.indexOf("/")&&(t=t.substr(1));var a={display_name:this.state.displayName,description:this.state.description,trigger:t,url:this.state.url.trim(),method:this.state.method,username:this.state.username,icon_url:this.state.iconUrl,auto_complete:this.state.autocomplete};if(this.originalCommand.id&&(a.id=this.originalCommand.id),a.auto_complete&&(a.auto_complete_desc=this.state.autocompleteDescription,a.auto_complete_hint=this.state.autocompleteHint),!a.trigger)return void this.setState({saving:!1,clientError:g.default.createElement(S.FormattedMessage,{id:"add_command.triggerRequired",defaultMessage:"A trigger word is required"})});if(0===a.trigger.indexOf("/"))return void this.setState({saving:!1,clientError:g.default.createElement(S.FormattedMessage,{id:"add_command.triggerInvalidSlash",defaultMessage:"A trigger word cannot begin with a /"})});if(-1!==a.trigger.indexOf(" "))return void this.setState({saving:!1,clientError:g.default.createElement(S.FormattedMessage,{id:"add_command.triggerInvalidSpace",defaultMessage:"A trigger word must not contain spaces"})});if(a.trigger.length<L.default.MIN_TRIGGER_LENGTH||a.trigger.length>L.default.MAX_TRIGGER_LENGTH)return void this.setState({saving:!1,clientError:g.default.createElement(S.FormattedMessage,{id:"add_command.triggerInvalidLength",defaultMessage:"A trigger word must contain between {min} and {max} characters",values:{min:L.default.MIN_TRIGGER_LENGTH,max:L.default.MAX_TRIGGER_LENGTH}})});if(!a.url)return void this.setState({saving:!1,clientError:g.default.createElement(S.FormattedMessage,{id:"add_command.urlRequired",defaultMessage:"A request URL is required"})});this.newCmd=a,this.originalCommand.url!==this.newCmd.url||this.originalCommand.trigger!==this.newCmd.trigger||this.originalCommand.method!==this.newCmd.method?(this.handleConfirmModal(),this.setState({saving:!1})):this.submitCommand()}}},{key:"updateDisplayName",value:function(e){this.setState({displayName:e.target.value})}},{key:"updateDescription",value:function(e){this.setState({description:e.target.value})}},{key:"updateTrigger",value:function(e){this.setState({trigger:e.target.value})}},{key:"updateUrl",value:function(e){this.setState({url:e.target.value})}},{key:"updateMethod",value:function(e){this.setState({method:e.target.value})}},{key:"updateUsername",value:function(e){this.setState({username:e.target.value})}},{key:"updateIconUrl",value:function(e){this.setState({iconUrl:e.target.value})}},{key:"updateAutocomplete",value:function(e){this.setState({autocomplete:e.target.checked})}},{key:"updateAutocompleteHint",value:function(e){this.setState({autocompleteHint:e.target.value})}},{key:"updateAutocompleteDescription",value:function(e){this.setState({autocompleteDescription:e.target.value})}},{key:"render",value:function(){var e=g.default.createElement(S.FormattedMessage,{id:"update_command.update",defaultMessage:"Update"}),t=g.default.createElement(S.FormattedMessage,{id:"update_command.confirm",defaultMessage:"Edit Slash Command"}),a=g.default.createElement(S.FormattedMessage,{id:"update_command.question",defaultMessage:"Your changes may break the existing slash command. Are you sure you would like to update it?"}),l=null;return this.state.autocomplete&&(l=[g.default.createElement("div",{key:"autocompleteHint",className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteHint"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocompleteHint",defaultMessage:"Autocomplete Hint"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"autocompleteHint",type:"text",maxLength:"1024",className:"form-control",value:this.state.autocompleteHint,onChange:this.updateAutocompleteHint,placeholder:y.localizeMessage("add_command.autocompleteHint.placeholder","Example: [Patient Name]")}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocompleteHint.help",defaultMessage:"(Optional) Arguments associated with your slash command, displayed as help in the autocomplete list."})))),g.default.createElement("div",{key:"autocompleteDescription",className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocompleteDescription"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocompleteDescription",defaultMessage:"Autocomplete Description"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.autocompleteDescription,onChange:this.updateAutocompleteDescription,placeholder:y.localizeMessage("add_command.autocompleteDescription.placeholder",'Example: "Returns search results for patient records"')}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocompleteDescription.help",defaultMessage:"(Optional) Short description of slash command for the autocomplete list."}))))]),g.default.createElement("div",{className:"backstage-content row"},g.default.createElement(w.default,null,g.default.createElement(D.Link,{to:"/"+this.props.team.name+"/integrations/commands"},g.default.createElement(S.FormattedMessage,{id:"installed_command.header",defaultMessage:"Slash Commands"})),g.default.createElement(S.FormattedMessage,{id:"integrations.edit",defaultMessage:"Edit"})),g.default.createElement("div",{className:"backstage-form"},g.default.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"displayName"},g.default.createElement(S.FormattedMessage,{id:"add_command.displayName",defaultMessage:"Display Name"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"displayName",type:"text",maxLength:"64",className:"form-control",value:this.state.displayName,onChange:this.updateDisplayName}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.displayName.help",defaultMessage:"Display name for your slash command made of up to 64 characters."})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"description"},g.default.createElement(S.FormattedMessage,{id:"add_command.description",defaultMessage:"Description"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"description",type:"text",maxLength:"128",className:"form-control",value:this.state.description,onChange:this.updateDescription}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.description.help",defaultMessage:"Description for your incoming webhook."})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"trigger"},g.default.createElement(S.FormattedMessage,{id:"add_command.trigger",defaultMessage:"Command Trigger Word"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"trigger",type:"text",maxLength:L.default.MAX_TRIGGER_LENGTH,className:"form-control",value:this.state.trigger,onChange:this.updateTrigger,placeholder:y.localizeMessage("add_command.trigger.placeholder",'Command trigger e.g. "hello" not including the slash')}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.trigger.help",defaultMessage:"Trigger word must be unique, and cannot begin with a slash or contain any spaces."})),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.trigger.helpExamples",defaultMessage:"Examples: client, employee, patient, weather"})),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.trigger.helpReserved",defaultMessage:"Reserved: {link}",values:{link:g.default.createElement("a",{href:"https://docs.mattermost.com/help/messaging/executing-commands.html#built-in-commands",target:"_blank",rel:"noopener noreferrer"},g.default.createElement(S.FormattedMessage,{id:"add_command.trigger.helpReservedLinkText",defaultMessage:"see list of built-in slash commands"}))}})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"url"},g.default.createElement(S.FormattedMessage,{id:"add_command.url",defaultMessage:"Request URL"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"url",type:"text",maxLength:"1024",className:"form-control",value:this.state.url,onChange:this.updateUrl,placeholder:y.localizeMessage("add_command.url.placeholder","Must start with http:// or https://")}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.url.help",defaultMessage:"The callback URL to receive the HTTP POST or GET event request when the slash command is run."})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"method"},g.default.createElement(S.FormattedMessage,{id:"add_command.method",defaultMessage:"Request Method"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("select",{id:"method",className:"form-control",value:this.state.method,onChange:this.updateMethod},g.default.createElement("option",{value:G},y.localizeMessage("add_command.method.post","POST")),g.default.createElement("option",{value:q},y.localizeMessage("add_command.method.get","GET"))),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.method.help",defaultMessage:"The type of command request issued to the Request URL."})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"username"},g.default.createElement(S.FormattedMessage,{id:"add_command.username",defaultMessage:"Response Username"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"username",type:"text",maxLength:"64",className:"form-control",value:this.state.username,onChange:this.updateUsername,placeholder:y.localizeMessage("add_command.username.placeholder","Username")}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.username.help",defaultMessage:'(Optional) Choose a username override for responses for this slash command. Usernames can consist of up to 22 characters consisting of lowercase letters, numbers and they symbols "-", "_", and "." .'})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"iconUrl"},g.default.createElement(S.FormattedMessage,{id:"add_command.iconUrl",defaultMessage:"Response Icon"})),g.default.createElement("div",{className:"col-md-5 col-sm-8"},g.default.createElement("input",{id:"iconUrl",type:"text",maxLength:"1024",className:"form-control",value:this.state.iconUrl,onChange:this.updateIconUrl,placeholder:y.localizeMessage("add_command.iconUrl.placeholder","https://www.example.com/myicon.png")}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.iconUrl.help",defaultMessage:"(Optional) Choose a profile picture override for the post responses to this slash command. Enter the URL of a .png or .jpg file at least 128 pixels by 128 pixels."})))),g.default.createElement("div",{className:"form-group"},g.default.createElement("label",{className:"control-label col-sm-4",htmlFor:"autocomplete"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocomplete",defaultMessage:"Autocomplete"})),g.default.createElement("div",{className:"col-md-5 col-sm-8 checkbox"},g.default.createElement("input",{id:"autocomplete",type:"checkbox",checked:this.state.autocomplete,onChange:this.updateAutocomplete}),g.default.createElement("div",{className:"form__help"},g.default.createElement(S.FormattedMessage,{id:"add_command.autocomplete.help",defaultMessage:"(Optional) Show slash command in autocomplete list."})))),l,g.default.createElement("div",{className:"backstage-form__footer"},g.default.createElement(x.default,{type:"backstage",errors:[this.state.serverError,this.state.clientError]}),g.default.createElement(D.Link,{className:"btn btn-sm",to:"/"+this.props.team.name+"/integrations/commands"},g.default.createElement(S.FormattedMessage,{id:"add_command.cancel",defaultMessage:"Cancel"})),g.default.createElement(R.default,{className:"btn btn-primary",type:"submit",spinning:this.state.saving,onClick:this.handleSubmit,disabled:this.state.loading},g.default.createElement(S.FormattedMessage,{id:"edit_command.save",defaultMessage:"Update"})),g.default.createElement(I.default,{title:t,message:a,confirmButton:e,show:this.state.showConfirmModal,onConfirm:this.handleUpdate,onCancel:this.confirmModalDismissed})))))}}]),t}(g.default.Component);t.default=O}});
//# sourceMappingURL=35.bfa4b578a116097a3cfa.js.map